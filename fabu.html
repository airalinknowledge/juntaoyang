<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <title>发布 - 杨君陶</title>
  <meta name="description" content="杨君陶的随笔与草稿" />
  <meta name="keywords" content="杨君陶, Juntao Yang, 发布, 随笔, 草稿, posts, drafts, notes" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>

  <script type="text/javascript">
    if (window.innerWidth < 768) {
      window.location.href = "fabu-mobile.html";
    }
  </script>

  <link id="wsite-base-style" rel="stylesheet" type="text/css" href="https://cdn2.editmysite.com/css/sites.css?buildTime=1234" />
  <link rel="stylesheet" type="text/css" href="https://cdn2.editmysite.com/css/old/fancybox.css?1234" />
  <link rel="stylesheet" type="text/css" href="https://cdn2.editmysite.com/css/social-icons.css?buildtime=1234" media="screen,projection" />
  <link rel="stylesheet" type="text/css" href="files/main_style.css?1714489767" title="wsite-theme-css" />
  <link href="https://cdn2.editmysite.com/fonts/Maven_Pro/font.css?2" rel="stylesheet" type="text/css" />
  <link href="https://cdn2.editmysite.com/fonts/Alike/font.css?2" rel="stylesheet" type="text/css" />
  <link href="https://cdn2.editmysite.com/fonts/Cardo/font.css?2" rel="stylesheet" type="text/css" />
  <link href="https://cdn2.editmysite.com/fonts/Amaranth/font.css?2" rel="stylesheet" type="text/css" />
  <link href="https://cdn2.editmysite.com/fonts/Cabin/font.css?2" rel="stylesheet" type="text/css" />

<!-- [START] 样式注入：完全同步 chuban.html 的样式定义 -->
<style>
    /* --- 0. 变量定义 (直接复制自 chuban.html) --- */
    :root {
        --font-serif: "Georgia", "Songti SC", "SimSun", "Times New Roman", serif;
        --font-mono: "Courier New", "Courier", monospace;
        
        --bg-paper: #f4f4f2;    /* 米白 */
        --text-ink: #1e1e1e;    /* 极深灰 */
        --text-meta: #5c5c5c;   /* 中灰 */
        
        /* 深岩蓝 / 普鲁士蓝 */
        --accent-slate: #3A4B5C; 
        
        --line-light: #d1d1d1;
    }

    /* --- 1. 全局字体与背景重置 --- */
    body, #wrapper, .wsite-background {
        font-family: var(--font-serif) !important;
        background-color: var(--bg-paper) !important;
        background-image: none !important; 
        color: var(--text-ink) !important;
    }

    /* [核心] 磨砂层 */
    .noise-overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
        opacity: 0.09; 
        pointer-events: none;
        z-index: 50; 
        mix-blend-mode: multiply; 
    }

    /* [核心] 地质层 */
    #geology-layer {
        position: fixed;
        top: 0;
        right: 0;
        width: 45vw; 
        height: 100vh;
        z-index: 40; 
        pointer-events: none;
        opacity: 0.8; 
        mix-blend-mode: multiply; 
        mask-image: linear-gradient(to right, transparent 0%, black 60%);
        -webkit-mask-image: linear-gradient(to right, transparent 0%, black 60%);
    }

    @media (max-width: 768px) {
        #geology-layer { display: none; }
    }

    /* --- 2. 文本样式升级 --- */
    /* 强制统一所有段落字体大小和行高，对齐 chuangzuo/guanyu */
    .paragraph, p, div {
        font-family: var(--font-serif) !important;
        line-height: 1.8 !important;
        font-size: 16px !important;
        color: var(--text-ink) !important;
    }

    /* 标题样式 */
    h2, .wsite-content-title {
        font-family: var(--font-serif) !important;
        font-weight: normal !important;
        letter-spacing: 2px !important;
        text-transform: uppercase !important;
        margin-bottom: 2rem !important;
        border-bottom: none !important; 
        padding-bottom: 10px !important;
        color: var(--text-ink) !important;
    }

    /* 链接样式 */
    a {
        color: var(--text-ink) !important;
        text-decoration: none !important;
        transition: all 0.3s ease;
    }

    a:hover {
        color: var(--accent-slate) !important; 
    }
    
    .paragraph u { text-decoration: none !important; }

    /* --- 3. 布局与间距 --- */
    /* 容器控制 */
    .writings-body {
        max-width: 900px !important; 
        width: auto !important;
        margin: 0 auto !important; 
        padding: 0 15px !important; 
        box-sizing: border-box !important; 
        font-family: var(--font-serif) !important;
    }

    .decorative-hr, .styled-hr {
        border: none;
        height: 1px;
        background-color: var(--line-light) !important;
        width: 100px; 
        margin: 80px auto; 
        opacity: 0.5;
    }
    
    /* --- 4. 导航栏 (严格复制 chuangzuo.html) --- */
    .wsite-menu-default a {
        font-family: var(--font-serif) !important;
        font-size: 14px !important;
        letter-spacing: 2px !important;
        color: var(--text-meta) !important;
        transition: color 0.3s ease;
        text-transform: uppercase !important;
    }
    .wsite-menu-default a:hover,
    #active a {
        color: var(--accent-slate) !important;
        background: transparent !important;
        border-bottom: 2px solid var(--accent-slate) !important;
    }

    /* [新增] 恢复文章标题加粗 (发布页专用) */
    .post-title, .post-title u {
        font-weight: bold !important; 
    }
</style>
<!-- [END] 样式注入 -->

<style type='text/css'>
/* --- 关键修正：从 chuban.html 移植的完整 Weebly CSS 块 --- */
.wsite-elements.wsite-not-footer:not(.wsite-header-elements) div.paragraph, .wsite-elements.wsite-not-footer:not(.wsite-header-elements) p, .wsite-elements.wsite-not-footer:not(.wsite-header-elements) .product-block .product-title, .wsite-elements.wsite-not-footer:not(.wsite-header-elements) .product-description, .wsite-elements.wsite-not-footer:not(.wsite-header-elements) .wsite-form-field label, .wsite-elements.wsite-not-footer:not(.wsite-header-elements) .wsite-form-field label, #wsite-content div.paragraph, #wsite-content p, #wsite-content .product-block .product-title, #wsite-content .product-description, #wsite-content .wsite-form-field label, #wsite-content .wsite-form-field label, .blog-sidebar div.paragraph, .blog-sidebar p, .blog-sidebar .wsite-form-field label, .blog-sidebar .wsite-form-field label {font-family:"Georgia" !important;}
#wsite-content div.paragraph, #wsite-content p, #wsite-content .product-block .product-title, #wsite-content .product-description, #wsite-content .wsite-form-field label, #wsite-content .wsite-form-field label, .blog-sidebar div.paragraph, .blog-sidebar p, .blog-sidebar .wsite-form-field label, .blog-sidebar .wsite-form-field label {}
.wsite-elements.wsite-footer div.paragraph, .wsite-elements.wsite-footer p, .wsite-elements.wsite-footer .product-block .product-title, .wsite-elements.wsite-footer .product-description, .wsite-elements.wsite-footer .wsite-form-field label, .wsite-elements.wsite-footer .wsite-form-field label{}
.wsite-elements.wsite-not-footer:not(.wsite-header-elements) h2, .wsite-elements.wsite-not-footer:not(.wsite-header-elements) .product-long .product-title, .wsite-elements.wsite-not-footer:not(.wsite-header-elements) .product-large .product-title, .wsite-elements.wsite-not-footer:not(.wsite-header-elements) .product-small .product-title, #wsite-content h2, #wsite-content .product-long .product-title, #wsite-content .product-large .product-title, #wsite-content .product-small .product-title, .blog-sidebar h2 {font-family:"Georgia" !important;font-style:normal !important;letter-spacing: 5px !important;}
#wsite-content h2, #wsite-content .product-long .product-title, #wsite-content .product-large .product-title, #wsite-content .product-small .product-title, .blog-sidebar h2 {}
.wsite-elements.wsite-footer h2, .wsite-elements.wsite-footer .product-long .product-title, .wsite-elements.wsite-footer .product-large .product-title, .wsite-elements.wsite-footer .product-small .product-title{}
#wsite-title {font-family:"Alike" !important;text-transform:  none !important;letter-spacing: -1px !important;}
.wsite-menu-default a {font-family:"Cardo" !important;text-transform:  uppercase !important;letter-spacing: 2px !important;}
.wsite-menu a {}
.wsite-image div, .wsite-caption {font-family:"Amaranth" !important;}
.galleryCaptionInnerText {}
.fancybox-title {}
.wslide-caption-text {}
.wsite-phone {}
.wsite-headline,.wsite-header-section .wsite-content-title {font-family:"Cabin" !important;}
.wsite-headline-paragraph,.wsite-header-section .paragraph {}
.wsite-button-inner {}
.wsite-not-footer blockquote {}
.wsite-footer blockquote {}
.blog-header h2 a {}
#wsite-content h2.wsite-product-title {}
.wsite-product .wsite-product-price a {}
@media screen and (min-width: 767px) {.wsite-elements.wsite-not-footer:not(.wsite-header-elements) div.paragraph, .wsite-elements.wsite-not-footer:not(.wsite-header-elements) p, .wsite-elements.wsite-not-footer:not(.wsite-header-elements) .product-block .product-title, .wsite-elements.wsite-not-footer:not(.wsite-header-elements) .product-description, .wsite-elements.wsite-not-footer:not(.wsite-header-elements) .wsite-form-field label, .wsite-elements.wsite-not-footer:not(.wsite-header-elements) .wsite-form-field label, #wsite-content div.paragraph, #wsite-content p, #wsite-content .product-block .product-title, #wsite-content .product-description, #wsite-content .wsite-form-field label, #wsite-content .wsite-form-field label, .blog-sidebar div.paragraph, .blog-sidebar p, .blog-sidebar .wsite-form-field label, .blog-sidebar .wsite-form-field label {line-height:33px !important;}
#wsite-content div.paragraph, #wsite-content p, #wsite-content .product-block .product-title, #wsite-content .product-description, #wsite-content .wsite-form-field label, #wsite-content .wsite-form-field label, .blog-sidebar div.paragraph, .blog-sidebar p, .blog-sidebar .wsite-form-field label, .blog-sidebar .wsite-form-field label {}
.wsite-elements.wsite-footer div.paragraph, .wsite-elements.wsite-footer p, .wsite-elements.wsite-footer .product-block .product-title, .wsite-elements.wsite-footer .product-description, .wsite-elements.wsite-footer .wsite-form-field label, .wsite-elements.wsite-footer .wsite-form-field label{}
.wsite-elements.wsite-not-footer:not(.wsite-header-elements) h2, .wsite-elements.wsite-not-footer:not(.wsite-header-elements) .product-long .product-title, .wsite-elements.wsite-not-footer:not(.wsite-header-elements) .product-large .product-title, .wsite-elements.wsite-not-footer:not(.wsite-header-elements) .product-small .product-title, #wsite-content h2, #wsite-content .product-long .product-title, #wsite-content .product-large .product-title, #wsite-content .product-small .product-title, .blog-sidebar h2 {font-size:100px !important;line-height:75px !important;}
#wsite-content h2, #wsite-content .product-long .product-title, #wsite-content .product-large .product-title, #wsite-content .product-small .product-title, .blog-sidebar h2 {}
.wsite-elements.wsite-footer h2, .wsite-elements.wsite-footer .product-long .product-title, .wsite-elements.wsite-footer .product-large .product-title, .wsite-elements.wsite-footer .product-small .product-title{}
#wsite-title {font-size:23px !important;}
.wsite-menu-default a {font-size:14px !important;}
.wsite-menu a {}
.wsite-image div, .wsite-caption {}
.galleryCaptionInnerText {}
.fancybox-title {}
.wslide-caption-text {}
.wsite-phone {}
.wsite-headline,.wsite-header-section .wsite-content-title {}
.wsite-headline-paragraph,.wsite-header-section .paragraph {}
.wsite-button-inner {}
.wsite-not-footer blockquote {}
.wsite-footer blockquote {}
.blog-header h2 a {}
#wsite-content h2.wsite-product-title {}
.wsite-product .wsite-product-price a {}
}
/* --- 移植结束 --- */

.wsite-background {
  background-image: none !important; 
  background-color: transparent !important;
}
body.wsite-background {background-attachment: fixed !important;}

/* 发布页专用布局样式 (保留) */
.post-entry-card {
    width: 100%;
    margin-bottom: 80px; 
}
.post-image {
    width: 100%;
    height: auto;
    display: block;
    margin-bottom: 15px;
}

.post-title a {
    text-decoration: none !important;
    color: #555 !important;
}
.post-title a:hover {
    color: #000 !important;
}

.post-date {
    font-family: "Georgia", serif;
    font-size: 12px !important; 
    color: #888;
    margin: 0 0 6px;
}
.post-excerpt {
    font-size: 14px !important;
}

.news-section .paragraph {
    margin-bottom: 15px;
    font-size: 15px;
}
.news-section a {
    text-decoration: underline;
    color: #555; 
}
.news-section a:hover {
    color: #000; 
}

.posts-column {
    padding-right: 60px !important;
}
.separator-wrapper {
    border-left: 1px solid #e0e0e0;
    padding-left: 60px;
    height: 100%;
}

.post-entry-card .paragraph { 
  margin: 6px 0 !important;
  line-height: 1.35;
}
.post-entry-card .post-image { 
  margin-bottom: 8px !important;
}
.post-entry-card .post-title { 
  margin: 6px 0 4px !important;
}
.post-entry-card .post-excerpt { 
  margin: 0 0 8px !important;
}
.wsite-elements .post-entry-card .paragraph {
  margin: 6px 0 !important;
}

.posts-two-col { display: flex; gap: 80px; }
.posts-left, .posts-right { flex: 1; display: flex; flex-direction: column; }

@media screen and (min-width: 767px) {
  .posts-right .post-entry-card:first-child { 
    margin-top: 80px;
  }
}

.posts-left .post-entry-card, .posts-right .post-entry-card { margin: 0 0 80px; width: 100%; }

@media (max-width: 767px) {
  .posts-two-col { display:block; }
  .posts-left, .posts-right { width:100%; }
  .posts-right .post-entry-card:first-child { margin-top: 0; }
  .separator-wrapper { border-left: none; padding-left: 0; margin-top: 40px; }
  .posts-column { padding-right: 15px !important; }
  .news-column { padding-left: 15px !important; }
}
</style>
<script src="https://cdn2.editmysite.com/js/jquery-1.8.3.min.js"></script>
</head>

<body class="no-header-page wsite-page-guanyu wsite-theme-light">
  
  <div id="geology-layer"></div>
  <div class="noise-overlay"></div>

  <div id="wrapper">
	<div id="navigation">
    <div id="navigation-wrap">
  	 	<div id="nav">
	      <div class="sitename"><span class="wsite-logo">

	
	<span class="wsite-title-placeholder">&nbsp;</span><span style="display:none">
	<span style="display:none">&nbsp;</span>
	</span>
	

</span></div>
				<ul class="wsite-menu-default">
						<li id="pg356461667194310790" class="wsite-menu-item-wrap">
							<a href="guanyu.html" class="wsite-menu-item">关于</a>
						</li>
						<li id="pg444862601486980856" class="wsite-menu-item-wrap">
							<a href="chuangzuo.html" class="wsite-menu-item">创作</a>
						</li>
						<li id="pg864040464600617228" class="wsite-menu-item-wrap">
							<a href="chuban.html" class="wsite-menu-item">出版</a>
						</li>
						<li id="pg361237216236019909" class="wsite-menu-item-wrap">
							<a href="xiangmu.html" class="wsite-menu-item">项目</a>
						</li>
						<li id="active" class="wsite-menu-item-wrap">
							<a href="fabu.html" class="wsite-menu-item">发布</a>
						</li>
				</ul>
			</div>
   	 	<div id="navmobile"><ul class="wsite-menu-default">
		<li id="pg356461667194310790" class="wsite-menu-item-wrap">
			<a href="guanyu.html" class="wsite-menu-item">关于</a>
		</li>
		<li id="pg444862601486980856" class="wsite-menu-item-wrap">
			<a href="chuangzuo.html" class="wsite-menu-item">创作</a>
		</li>
		<li id="pg864040464600617228" class="wsite-menu-item-wrap">
			<a href="chuban.html" class="wsite-menu-item">出版</a>
		</li>
		<li id="pg361237216236019909" class="wsite-menu-item-wrap">
			<a href="xiangmu.html" class="wsite-menu-item">项目</a>
		</li>
		<li id="pg497557010409593207" class="wsite-menu-item-wrap">
			<a href="fabu.html" class="wsite-menu-item">发布</a>
		</li>
</ul>
</div>
    </div>
		<label id="mobile-close" class="hamburger" for="mobile-input"></label>
	</div>

    <div id="main">
      <div id="mobile-top">
        <label id="mobile-open" class="hamburger" for="mobile-input"></label>
        <div class="sitename">
          <span class="wsite-logo"><span class="wsite-title-placeholder">&nbsp;</span><span style="display:none"><span style="display:none">&nbsp;</span></span></span>
        </div>
      </div>
      <div id="content-wrapper">
        <div id="wsite-content" class="wsite-elements wsite-not-footer">
          <div class="wsite-section-wrap">
            <div class="wsite-section wsite-body-section wsite-background-5 wsite-custom-background" style="min-height: 951px; padding-bottom: 40px;">
              <div class="wsite-section-content">
                <div class="container">
                  <div class="wsite-section-elements">
                    <div>
                      <div class="wsite-multicol">
                        <div class="wsite-multicol-table-wrap" style="margin:0 -15px;">
                          <table class="wsite-multicol-table">
                            <tbody class="wsite-multicol-tbody">
                              <tr class="wsite-multicol-tr">
                                <td class="wsite-multicol-col" style="width:36.894273127753%; padding:0 15px;">
                                  <div class="paragraph" style="text-align:left;"><font size="3"><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</strong><u><a href="posts.html"><font color="#2a2a2a">English</font></a></u>&nbsp; &nbsp; &nbsp;&nbsp; &nbsp;<font color="#2a2a2a">&nbsp;</font><strong>中文</strong><br />&#8203;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;juntao.yang@columbia.edu</font></div>
                                </td>
                                <td class="wsite-multicol-col" style="width:63.105726872247%; padding:0 15px;">
                                  <div class="paragraph" style="text-align:right;"><font size="4"><u><a href="guanyu.html"><font color="#2a2a2a">关于</font></a></u><font color="#2a2a2a">&nbsp; &nbsp;</font><u><a href="chuangzuo.html"><font color="#2a2a2a">创作</font></a></u><font color="#2a2a2a">&nbsp; &nbsp;</font><u><a href="chuban.html"><font color="#2a2a2a">出版</font></a></u><font color="#2a2a2a">&nbsp; &nbsp;</font><u><a href="xiangmu.html"><font color="#2a2a2a">项目</font></a></u><font color="#2a2a2a">&nbsp;</font>&nbsp;&nbsp;<strong><font color="#2a2a2a">发布</font></strong></font></div>
                                </td>
                              </tr>
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                    
                    <div class="wsite-spacer" style="height:50px;"></div>
                    <h2 class="wsite-content-title">发布</h2>
                    <div class="wsite-spacer" style="height:100px;"></div>
                    <div class="paragraph" style="text-align:left; font-style:italic; color:#555;">
                        此页面包含我最近的更新和一些写作片段。这些内容可能是临时的、未经深思熟虑的、非正式的——现在尚未发表，也许永远不会。
                        <br><br>
                        点击<a href="review.html" style="color: inherit; font-weight: bold; text-decoration: underline;">此处</a>查看我持续更新中的艺术短评与札记。
                    </div>
                    <div style="height: 30px; overflow: hidden; width: 100%;"></div>
                    <hr class="styled-hr" style="width:100%;"></hr>
                    <div class="wsite-spacer" style="height:50px;"></div>
                    <div class="wsite-multicol">
                      <div class="wsite-multicol-table-wrap" style="margin:0 -15px;">
                        <table class="wsite-multicol-table">
                          <tbody class="wsite-multicol-tbody">
                            <tr class="wsite-multicol-tr">
                              <td class="wsite-multicol-col posts-column" style="width:75%; padding:0 15px; vertical-align: top;">
                                
                                <div class="posts-two-col" id="posts-container" aria-live="polite">
                                  <div class="posts-left" id="posts-left">
                                      </div>
                                  <div class="posts-right" id="posts-right">
                                      </div>
                                </div>
                                </td>

                              <td class="wsite-multicol-col news-column" style="width:25%; padding:0 15px; vertical-align: top;">
                                <div class="separator-wrapper">
                                  <div class="news-section">
                                    <div class="paragraph"><u><font size="4">消息</font></u></div>
                                    
                                    <div id="news-list">
                                      </div>
                                    </div>
                                </div>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                    <div class="paragraph" style="text-align:center;">
                      <br /><br /><br /><br /><font size="2"><br />版权所有&nbsp;&copy;&nbsp; 杨君陶</font>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script type="text/javascript" src="files/theme/plugins.js"></script>
  <script type="text/javascript" src="files/theme/custom.js"></script>
  <script type="text/javascript" src="files/theme/mobile.js"></script>

  <script>
    /* 1. 定义 Worker 端点 (Endpoint) */
    const ENDPOINT = 'https://posts.airalinknowledge.workers.dev/?db=posts';
  
    /* 2. 安全转义 (Escape) HTML */
    const esc = s => s ? String(s).replace(/[&<>"']/g, m => (
      {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]
    )) : '';
  
    /* 3. 日期格式化 (Format Date) - 中文版 */
    const fmtD2 = iso => {
      if (!iso) return '';
      try {
        const datePart = iso.split('T')[0];
        const parts = datePart.split('-'); // [YYYY, MM, DD]
        if (parts.length < 3) return iso;
        const year = parts[0];
        const month = parseInt(parts[1], 10);
        const day = parseInt(parts[2], 10);
        return `${year}年${month}月${day}日`;
      } catch { return iso; }
    };
  
    /* 4. 获取所有数据 (Fetch All) */
    async function fetchAll() {
      const url = ENDPOINT + '&all=1&_=' + Date.now();
      const { items = [] } = await fetch(url, { cache: 'no-store' }).then(r => r.json());
      return items;
    }
  
    /* 5. 渲染卡片 (Render Card) */
    const renderPostCard = (x) => {
      const link = x.link ? esc(x.link) : '#';
      const title = esc(x.title || '无标题');
      const excerpt = esc(x.comment);
      const date = x.date ? esc(fmtD2(x.date)) : '';
      const image = x.poster ? `<a href="${link}"><img src="${esc(x.poster)}" class="post-image" alt="${title}" loading="lazy" decoding="async"></a>` : '';
  
      return `
        <div class="post-entry-card">
          ${image}
          <div class="paragraph post-title">
            <a href="${link}"><u><font size="4">${title}</font></u></a>
          </div>
          <div class="paragraph post-date">${date}</div>
          <div class="paragraph post-excerpt">${excerpt}</div>
        </div>`;
    };
  
    /* 6. 执行 (Execute) */
    fetchAll()
      .then(items => {
        const leftCol = document.getElementById('posts-left');
        const rightCol = document.getElementById('posts-right');
        const container = document.getElementById('posts-container');
  
        if (!leftCol || !rightCol) {
           if (container) container.innerHTML = "<p class='paragraph'>加载失败：找不到 #posts-left 或 #posts-right 容器。</p>";
           console.error("Error: Page layout missing #posts-left or #posts-right.");
           return;
        }
        if (!Array.isArray(items) || !items.length) {
          leftCol.innerHTML = '<div class="paragraph">暂无记录。</div>';
          return;
        }
  
        items.sort((a, b) => new Date(b.date || 0) - new Date(a.date || 0));
  
        const leftItems = [];
        const rightItems = [];
        items.forEach((item, index) => {
          if (index % 2 === 0) {
            leftItems.push(item);
          } else {
            rightItems.push(item);
          }
        });
  
        leftCol.innerHTML = leftItems.map(renderPostCard).join('');
        rightCol.innerHTML = rightItems.map(renderPostCard).join('');
      })
      .catch(e => {
        const container = document.getElementById('posts-container');
        const errorMsg = `<div class="paragraph">加载失败：${esc(String(e))}</div>`;
        if (container) {
          container.innerHTML = errorMsg;
        } else {
          document.body.insertAdjacentHTML('beforeend', errorMsg);
        }
        console.error(e);
      });

    /* --- News Fetching Logic (Localized) --- */
    async function fetchNews() {
      const url = 'https://posts.airalinknowledge.workers.dev/?db=news&all=1&publishedOnly=0&_=' + Date.now();
      const { items = [] } = await fetch(url, { cache: 'no-store' }).then(r => r.json());
      return items;
    }

    const renderNewsItem = (x) => {
      let d = '';

      if (x.dateRange?.start) {
        const s = fmtD2(x.dateRange.start);
        const e = x.dateRange.end ? fmtD2(x.dateRange.end) : '';
        d = e ? `${s} – ${e}` : s;
      } else if (x.date) {
        d = fmtD2(x.date);
      } else if (x.dateText) {
        d = x.dateText;
      }

      const t = esc(x.title || '');
      const c = esc(x.comment || '');
      const link = x.link ? ` <a href="${esc(x.link)}">[详情]</a>` : '';
      const body = t && c ? `${t} — ${c}` : (t || c);

      return `<div class="paragraph"><b>${esc(d)}:</b> ${body}${link}</div>`;
    };

    fetchNews()
      .then(list => {
        const box = document.getElementById('news-list');
        if (!box) return;
        if (!list.length) {
          box.innerHTML = `<div class="paragraph" style="color:#888">暂无消息。</div>`;
          return;
        }
        box.innerHTML = list.map(renderNewsItem).join('');
      })
      .catch(e => {
        const box = document.getElementById('news-list');
        if (box) box.innerHTML = `<div class="paragraph" style="color:#a00">加载失败：${esc(String(e))}</div>`;
        console.error(e);
      });
  </script>
  <script>
    new p5(function(p) {
        let cols, rows;
        let field = [];
        const REZ = 8; // 分辨率
        const ACCENT_COLOR = p.color(58, 75, 92); // #3A4B5C 深岩蓝
        
        p.setup = function() {
            let container = document.getElementById('geology-layer');
            let w = container.offsetWidth;
            let h = container.offsetHeight;
            let cnv = p.createCanvas(w, h);
            cnv.parent('geology-layer');
            
            // [关键优化] 停止循环，只渲染一次！彻底释放CPU
            p.noLoop();
            
            p.cols = 1 + Math.ceil(w / REZ);
            p.rows = 1 + Math.ceil(h / REZ);
            
            for (let i = 0; i < p.cols; i++) {
                field[i] = new Float32Array(p.rows);
            }
            
            p.strokeJoin(p.ROUND);
            p.noFill();
            
            // 执行一次性绘制
            generateGeology();
        };

        function generateGeology() {
            p.clear();
            
            let zOff = p.random(100); 

            for (let i = 0; i < p.cols; i++) {
                for (let j = 0; j < p.rows; j++) {
                    let x = i * REZ;
                    let y = j * REZ;
                    let val = p.noise(x * 0.003, y * 0.003, zOff);
                    field[i][j] = val;
                }
            }

            p.strokeWeight(1.4); 
            let numIsolines = 90; 
            
            for (let i = 0; i < p.cols - 1; i++) {
                for (let j = 0; j < p.rows - 1; j++) {
                    let x = i * REZ;
                    let y = j * REZ;
                    
                    let valTL = field[i][j];
                    let valTR = field[i+1][j];
                    let valBR = field[i+1][j+1];
                    let valBL = field[i][j+1];

                    let minLvl = Math.floor(Math.min(valTL, valTR, valBR, valBL) * numIsolines);
                    let maxLvl = Math.floor(Math.max(valTL, valTR, valBR, valBL) * numIsolines);

                    if (maxLvl > minLvl) {
                        for (let k = minLvl + 1; k <= maxLvl; k++) {
                            let threshold = k / numIsolines;
                            
                            let alpha = p.map(i, 0, p.cols, 0, 40); 
                            ACCENT_COLOR.setAlpha(alpha);
                            p.stroke(ACCENT_COLOR);

                            let state = getState(valTL, valTR, valBR, valBL, threshold);
                            let a = p.createVector(x + REZ * (threshold - valTL) / (valTR - valTL), y);
                            let b = p.createVector(x + REZ, y + REZ * (threshold - valTR) / (valBR - valTR));
                            let c = p.createVector(x + REZ * (threshold - valBL) / (valBR - valBL), y + REZ);
                            let d = p.createVector(x, y + REZ * (threshold - valTL) / (valBL - valTL));

                            switch (state) {
                                case 1:  drawLine(c, d); break;
                                case 2:  drawLine(b, c); break;
                                case 3:  drawLine(b, d); break;
                                case 4:  drawLine(a, b); break;
                                case 5:  drawLine(a, d); drawLine(b, c); break;
                                case 6:  drawLine(a, c); break;
                                case 7:  drawLine(a, d); break;
                                case 8:  drawLine(a, d); break;
                                case 9:  drawLine(a, c); break;
                                case 10: drawLine(a, b); drawLine(c, d); break;
                                case 11: drawLine(a, b); break;
                                case 12: drawLine(b, d); break;
                                case 13: drawLine(b, c); break;
                                case 14: drawLine(c, d); break;
                            }
                        }
                    }
                }
            }
        }

        function getState(tl, tr, br, bl, t) {
            return (tl >= t ? 8 : 0) + (tr >= t ? 4 : 0) + (br >= t ? 2 : 0) + (bl >= t ? 1 : 0);
        }

        function drawLine(v1, v2) {
            p.line(v1.x, v1.y, v2.x, v2.y);
        }

        p.windowResized = function() {
            let container = document.getElementById('geology-layer');
            p.resizeCanvas(container.offsetWidth, container.offsetHeight);
            p.cols = 1 + Math.ceil(p.width / REZ);
            p.rows = 1 + Math.ceil(p.height / REZ);
            for (let i = 0; i < p.cols; i++) {
                field[i] = new Float32Array(p.rows);
            }
            generateGeology();
        };
    });
</script>
</body>
</html>