<!DOCTYPE html>
<html lang="en">
<head>
  <title>Posts - Juntao Yang</title>
  <meta name="description" content="Juntao Yang's informal posts, drafts, and notes; 杨君陶的随笔与草稿" />
  <meta name="keywords" content="Juntao Yang,杨君陶, posts, drafts, notes, 随笔, 草稿" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link id="wsite-base-style" rel="stylesheet" type="text/css" href="https://cdn2.editmysite.com/css/sites.css?buildTime=1234" />
  <link rel="stylesheet" type="text/css" href="https://cdn2.editmysite.com/css/old/fancybox.css?1234" />
  <link rel="stylesheet" type="text/css" href="https://cdn2.editmysite.com/css/social-icons.css?buildtime=1234" media="screen,projection" />
  <link rel="stylesheet" type="text/css" href="files/main_style.css?1714489767" title="wsite-theme-css" />
  <link href="https://cdn2.editmysite.com/fonts/Maven_Pro/font.css?2" rel="stylesheet" type="text/css" />
  <link href="https://cdn2.editmysite.com/fonts/Alike/font.css?2" rel="stylesheet" type="text/css" />
  <link href="https://cdn2.editmysite.com/fonts/Cardo/font.css?2" rel="stylesheet" type="text/css" />
  <link href="https://cdn2.editmysite.com/fonts/Amaranth/font.css?2" rel="stylesheet" type="text/css" />
  <link href="https://cdn2.editmysite.com/fonts/Cabin/font.css?2" rel="stylesheet" type="text/css" />
  <style type="text/css">
    /* Copied styles from your site */
    .wsite-elements.wsite-not-footer:not(.wsite-header-elements) div.paragraph, .wsite-elements.wsite-not-footer:not(.wsite-header-elements) p, .wsite-elements.wsite-not-footer:not(.wsite-header-elements) .product-block .product-title, .wsite-elements.wsite-not-footer:not(.wsite-header-elements) .product-description, .wsite-elements.wsite-not-footer:not(.wsite-header-elements) .wsite-form-field label, #wsite-content div.paragraph, #wsite-content p, #wsite-content .product-block .product-title, #wsite-content .product-description, #wsite-content .wsite-form-field label, .blog-sidebar div.paragraph, .blog-sidebar p, .blog-sidebar .wsite-form-field label {font-family:"Georgia" !important;}
    #wsite-content div.paragraph, #wsite-content p, #wsite-content .product-block .product-title, #wsite-content .product-description, #wsite-content .wsite-form-field label, .blog-sidebar div.paragraph, .blog-sidebar p, .blog-sidebar .wsite-form-field label {}
    .wsite-elements.wsite-footer div.paragraph, .wsite-elements.wsite-footer p, .wsite-elements.wsite-footer .product-block .product-title, .wsite-elements.wsite-footer .product-description, .wsite-elements.wsite-footer .wsite-form-field label {}
    .wsite-elements.wsite-not-footer:not(.wsite-header-elements) h2, .wsite-elements.wsite-not-footer:not(.wsite-header-elements) .product-long .product-title, .wsite-elements.wsite-not-footer:not(.wsite-header-elements) .product-large .product-title, .wsite-elements.wsite-not-footer:not(.wsite-header-elements) .product-small .product-title, #wsite-content h2, #wsite-content .product-long .product-title, #wsite-content .product-large .product-title, #wsite-content .product-small .product-title, .blog-sidebar h2 {font-family:"Georgia" !important;font-style:normal !important;letter-spacing: 5px !important;}
    #wsite-content h2, #wsite-content .product-long .product-title, #wsite-content .product-large .product-title, #wsite-content .product-small .product-title, .blog-sidebar h2 {}
    .wsite-elements.wsite-footer h2, .wsite-elements.wsite-footer .product-long .product-title, .wsite-elements.wsite-footer .product-large .product-title, .wsite-elements.wsite-footer .product-small .product-title {}
    #wsite-title {font-family:"Alike" !important;text-transform: none !important;letter-spacing: -1px !important;}
    .wsite-menu-default a {font-family:"Cardo" !important;text-transform: uppercase !important;letter-spacing: 2px !important;}
    .wsite-menu a {}
    .wsite-image div, .wsite-caption {font-family:"Amaranth" !important;}
    .galleryCaptionInnerText {}
    .fancybox-title {}
    .wslide-caption-text {}
    .wsite-phone {}
    .wsite-headline, .wsite-header-section .wsite-content-title {font-family:"Cabin" !important;}
    .wsite-headline-paragraph, .wsite-header-section .paragraph {}
    .wsite-button-inner {}
    .wsite-not-footer blockquote {}
    .wsite-footer blockquote {}
    .blog-header h2 a {}
    #wsite-content h2.wsite-product-title {}
    .wsite-product .wsite-product-price a {}
  </style>
  <style>
    .wsite-background {
      background-image: url("/uploads/1/4/8/1/148137552/background-images/1199586110.jpg") !important;
      background-repeat: no-repeat !important;
      background-position: 50% 50% !important;
      background-size: 100% !important;
      background-color: transparent !important;
      background: inherit;
    }
    body.wsite-background {background-attachment: fixed !important;}
    .wsite-background.wsite-custom-background { background-size: cover !important; }
    
    .post-entry-card {
        width: 100%;
        margin-bottom: 60px; 
    }
    .post-image {
        width: 100%;
        height: auto;
        display: block;
        margin-bottom: 15px;
    }

    .post-title a {
        text-decoration: none !important;
        color: #555 !important;
    }
    .post-title a:hover {
        color: #000 !important;
    }

    .post-date {
        font-family: "Georgia", serif;
        font-size: 12px !important; 
        color: #888;
        margin: 0 0 6px;
    }
    .post-excerpt {
        font-size: 14px !important;
    }

    .news-section {
        margin-top: 40px;
    }
    .news-section .paragraph {
        margin-bottom: 15px;
        font-size: 15px;
    }
    .news-section a {
        text-decoration: underline;
        color: #555; /* 保持与桌面版一致 */
    }
    .news-section a:hover {
        color: #000; /* 保持与桌面版一致 */
    }
    
    .post-entry-card .paragraph { 
      margin: 6px 0 !important;
      line-height: 1.35;
    }
    .post-entry-card .post-image { 
      margin-bottom: 8px !important;
    }
    .post-entry-card .post-title { 
      margin: 6px 0 4px !important;
    }
    .post-entry-card .post-excerpt { 
      margin: 0 0 8px !important;
    }
    .wsite-elements .post-entry-card .paragraph {
      margin: 6px 0 !important;
    }
    .styled-hr {
        border: 0;
        height: 1px;
        background-color: #e0e0e0;
    }
  </style>
  <script src="https://cdn2.editmysite.com/js/jquery-1.8.3.min.js"></script>
  </head>

<body class="no-header-page  wsite-page-index wsite-theme-light">
  <div id="wrapper">
    <div id="navigation">
      <div id="navigation-wrap">
        <div id="nav">
          <div class="sitename">
            <span class="wsite-logo">
              <span class="wsite-title-placeholder">&nbsp;</span>
              <span style="display:none"><span style="display:none">&nbsp;</span></span>
            </span>
          </div>
          <ul class="wsite-menu-default">
            <li class="wsite-menu-item-wrap"><a href="index.html" class="wsite-menu-item">About</a></li>
            <li class="wsite-menu-item-wrap"><a href="artworks.html" class="wsite-menu-item">ARTWORKS</a></li>
            <li class="wsite-menu-item-wrap"><a href="writings.html" class="wsite-menu-item">Writings</a></li>
            <li class="wsite-menu-item-wrap"><a href="projects.html" class="wsite-menu-item">Projects</a></li>
            <li id="active" class="wsite-menu-item-wrap"><a href="posts.html" class="wsite-menu-item">Posts</a></li> </ul>
        </div>
        <div id="navmobile">
          <ul class="wsite-menu-default">
            <li class="wsite-menu-item-wrap"><a href="index.html" class="wsite-menu-item">About</a></li>
            <li class="wsite-menu-item-wrap"><a href="artworks.html" class="wsite-menu-item">ARTWORKS</a></li>
            <li class="wsite-menu-item-wrap"><a href="writings.html" class="wsite-menu-item">Writings</a></li>
            <li class="wsite-menu-item-wrap"><a href="projects.html" class="wsite-menu-item">Projects</a></li>
            <li id="active" class="wsite-menu-item-wrap"><a href="posts.html" class="wsite-menu-item">Posts</a></li>
          </ul>
        </div>
      </div>
      <label id="mobile-close" class="hamburger" for="mobile-input"></label>
    </div>
    <div id="main">
      <div id="mobile-top">
        <label id="mobile-open" class="hamburger" for="mobile-input"></label>
        <div class="sitename">
          <span class="wsite-logo"><span class="wsite-title-placeholder">&nbsp;</span><span style="display:none"><span style="display:none">&nbsp;</span></span></span>
        </div>
      </div>
      <div id="content-wrapper">
        <div id="wsite-content" class="wsite-elements wsite-not-footer">
          <div class="wsite-section-wrap">
            <div class="wsite-section wsite-body-section wsite-background-5 wsite-custom-background" style="min-height: 951px; padding-bottom: 40px;">
              <div class="wsite-section-content">
                <div class="container" style="padding: 0 15px;">
                  <div class="wsite-section-elements">
                    <div>
                      <div class="wsite-multicol">
                        <div class="wsite-multicol-table-wrap" style="margin:0 -15px;">
                          <table class="wsite-multicol-table">
                            <tbody class="wsite-multicol-tbody">
                              <tr class="wsite-multicol-tr">
                                <td class="wsite-multicol-col" style="width:36.89%; padding:0 15px;">
                                  <div class="paragraph" style="text-align:left;"><font size="3"><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</strong><strong>English</strong>&nbsp; &nbsp; &nbsp; &nbsp;<font color="#2a2a2a">&nbsp;</font><u><a href="fabu.html"><font color="#2a2a2a">&#20013;&#25991;</font></a></u><br />&#8203;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;juntao.yang@columbia.edu</font></div>
                                </td>
                                <td class="wsite-multicol-col" style="width:63.10%; padding:0 15px;">
                                  <div class="paragraph" style="text-align:right;"><font size="4"><u><a href="index.html"><font color="#2a2a2a">ABOUT</font></a></u><font color="#2a2a2a">&nbsp; &nbsp; </font><u><a href="artworks.html"><font color="#2a2a2a">ARTWORKS</font></a></u><font color="#2a2a2a">&nbsp; &nbsp;&nbsp;</font><u><a href="writings.html"><font color="#2a2a2a">WRITINGS</font></a></u><font color="#2a2a2a">&nbsp; &nbsp;&nbsp;</font><u><a href="projects.html"><font color="#2a2a2a">PROJECTS</font></a></u><font color="#2a2a2a">&nbsp;</font>&nbsp; &nbsp;<strong><font color="#2a2a2a">POSTS</font></strong>&nbsp;&nbsp;</font></div>
                                </td>
                              </tr>
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                    
                    <div>
                        <div style="height: 50px; overflow: hidden; width: 100%;"></div>
                        <h2 class="wsite-content-title" style="text-align:left;">Posts</h2>
                        <div style="height: 20px; overflow: hidden; width: 100%;"></div>
                        <hr class="styled-hr" style="width:100%;"></hr>
                        <div style="height: 20px; overflow: hidden; width: 100%;"></div>
                    </div>
                    <div class="paragraph" style="text-align:left; font-style:italic; color:#555;">
                        This page contains recent updates and fragments of my writing. These pieces may be temporary, unconsidered, and informal—unpublished now, and perhaps forever.
                        <br><br>
                        Click <a href="review.html" style="color: inherit;"><u>here</u></a> for my continuously updated short reviews and notes on films, theaters, performances and artworks.
                    </div>
                    
                    <div style="height: 30px; overflow: hidden; width: 100%;"></div>
                    <hr class="styled-hr" style="width:100%;"></hr>
                    <div class="wsite-spacer" style="height:50px;"></div>

                    <!-- [START] Dynamic Posts Container -->
                    <div id="posts-container-mobile" aria-live="polite">
                      <!-- Static content removed, will be filled by JS -->
                    </div>
                    <!-- [END] Dynamic Posts Container -->


                    <div class="news-section">
                        <div class="paragraph"><u><font size="4">News</font></u></div>
                        <!-- [START] Dynamic News List -->
                        <div id="news-list">
                          <!-- Static content removed, will be filled by JS -->
                        </div>
                        <!-- [END] Dynamic News List -->
                    </div>
                    
                    <div class="paragraph" style="text-align:center;">
                      <br /><br /><br /><br /><font size="2"><br />All Rights Reserved&nbsp;&copy;&nbsp; Juntao Yang</font>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script type="text/javascript" src="files/theme/plugins.js"></script>
  <script type="text/javascript" src="files/theme/custom.js"></script>
  <script type="text/javascript" src="files/theme/mobile.js"></script>

  <!-- [START] Dynamic Content Script -->
  <script>
    /* 1. 定义 Worker 端点 (Endpoint) */
    const ENDPOINT_POSTS = 'https://posts.airalinknowledge.workers.dev/?db=posts';
    const ENDPOINT_NEWS = 'https://posts.airalinknowledge.workers.dev/?db=news';
  
    /* 2. 安全转义 (Escape) HTML */
    const esc = s => s ? String(s).replace(/[&<>"']/g, m => (
      {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]
    )) : '';
  
    /* 3. 日期格式化 (Format Date) */
    //    (e.g., "October 24, 2025")
    const fmtD2 = iso => {
      if (!iso) return '';
      try {
        // 支持 YYYY-MM-DD 或 YYYY-MM-DDTHH:MM:SS...
        const datePart = iso.split('T')[0];
        const parts = datePart.split('-');
        if (parts.length < 1) return iso;
        const d = new Date(Date.UTC(parts[0], (parts[1] || 1) - 1, parts[2] || 1));
        // 使用 month: 'long' 来显示完整月份
        return d.toLocaleDateString('en-US', { timeZone: 'UTC', year:'numeric', month:'long', day:'2-digit' });
      } catch { return iso; }
    };
  
    /* 4. POSTS: 获取所有数据 (Fetch All Posts) */
    async function fetchAllPosts() {
      // 添加 &all=1, cache: 'no-store' 和时间戳
      const url = ENDPOINT_POSTS + '&all=1&_=' + Date.now();
      const { items = [] } = await fetch(url, { cache: 'no-store' }).then(r => r.json());
      return items;
    }
  
    /* 5. POSTS: 渲染卡片 (Render Post Card) */
    const renderPostCard = (x) => {
      const link = x.link ? esc(x.link) : '#';
      const title = esc(x.title || 'Untitled Post'); // 确保 title 有回退
      const excerpt = esc(x.comment); // 使用 comment 字段作为 excerpt
      const date = x.date ? esc(fmtD2(x.date)) : '';
      // 优化：添加 alt, loading="lazy", decoding="async"
      const image = x.poster ? `<a href="${link}"><img src="${esc(x.poster)}" class="post-image" alt="${title}" loading="lazy" decoding="async"></a>` : '';
  
      return `
        <div class="post-entry-card">
          ${image}
          <div class="paragraph post-title">
            <a href="${link}"><u><font size="4">${title}</font></u></a>
          </div>
          <div class="paragraph post-date">${date}</div>
          <div class="paragraph post-excerpt">${excerpt}</div>
        </div>`;
    };
  
    /* 6. POSTS: 执行 (Execute Posts) */
    fetchAllPosts()
      .then(items => {
        const container = document.getElementById('posts-container-mobile');
  
        if (!container) {
           console.error("Error: Page layout missing #posts-container-mobile.");
           return;
        }
        if (!Array.isArray(items) || !items.length) {
          container.innerHTML = '<div class="paragraph">暂无记录。</div>';
          return;
        }
  
        // 7. 按日期排序 (Sort by Date)
        items.sort((a, b) => new Date(b.date || 0) - new Date(a.date || 0));
  
        // 8. 渲染到单栏 (Render to single column)
        container.innerHTML = items.map(renderPostCard).join('');
      })
      .catch(e => {
        // 捕获错误 (Catch Errors)
        const container = document.getElementById('posts-container-mobile');
        const errorMsg = `<div class="paragraph">加载失败：${esc(String(e))}</div>`;
        if (container) {
          container.innerHTML = errorMsg;
        } else {
          document.body.insertAdjacentHTML('beforeend', errorMsg);
        }
        console.error(e);
      });

    /* --- 7. NEWS: Fetching Logic --- */
    async function fetchNews() {
      const url = ENDPOINT_NEWS + '&all=1&publishedOnly=0&_=' + Date.now();
      const { items = [] } = await fetch(url, { cache: 'no-store' }).then(r => r.json());
      return items;
    }

    /* 8. NEWS: Render Item (使用你提供的正确版本) */
    const renderNewsItem = (x) => {
      let d = '';

      if (x.dateRange?.start) {
        const s = fmtD2(x.dateRange.start);
        const e = x.dateRange.end ? fmtD2(x.dateRange.end) : '';
        d = e ? `${s} – ${e}` : s;
      } else if (x.date) {
        d = fmtD2(x.date);
      } else if (x.dateText) {
        d = x.dateText;
      }

      const t = esc(x.title || '');
      const c = esc(x.comment || '');
      const link = x.link ? ` <a href="${esc(x.link)}">[Details]</a>` : '';
      const body = t && c ? `${t} — ${c}` : (t || c);

      return `<div class="paragraph"><b>${esc(d)}:</b> ${body}${link}</div>`;
    };

    /* 9. NEWS: 渲染 (Render News) */
    fetchNews()
      .then(list => {
        const box = document.getElementById('news-list');
        if (!box) return;
        if (!list.length) {
          box.innerHTML = `<div class="paragraph" style="color:#888">No updates yet.</div>`;
          return;
        }
        box.innerHTML = list.map(renderNewsItem).join('');
      })
      .catch(e => {
        const box = document.getElementById('news-list');
        if (box) box.innerHTML = `<div class="paragraph" style="color:#a00">Load failed: ${esc(String(e))}</div>`;
        console.error(e);
      });
  </script>
  <!-- [END] Dynamic Content Script -->

</body>
</html>
